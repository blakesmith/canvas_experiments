<html>
  <head>
    <title>Canvas template</title>
    <script type="text/javascript">
      var NUMBER_OF_RECTANGLES = 100;

      var RotatingRectangle = function(opts){
        var rotationState = 0;
        this.draw = function(ctx){

          if (opts.direction){
            rotationState += opts.rotationSpeed;
          }
          else {
            rotationState -= opts.rotationSpeed;
          }

          ctx.save();
          ctx.translate(opts.x+(opts.width/2), opts.y+(opts.height/2));
          ctx.rotate(rotationState);
          ctx.fillStyle = opts.fillColor;
          ctx.fillRect(0-(opts.width/2), 0-(opts.height/2), opts.width, opts.height);
          ctx.restore();
        }
      }

      function init(){
        setInterval(draw, 30);
      }

      function generateShapes(count){
        var allShapes = [];
        for (i=0; i < count; ++i) {
          var red = Math.floor(Math.random() * 256);
          var green = Math.floor(Math.random() * 256);
          var blue = Math.floor(Math.random() * 256);
          var opacity = Math.random();
          var direction = Math.round(Math.random()) == 0 ? false : true
          var rect = new RotatingRectangle({
            x: Math.floor(Math.random() * 640), 
            y: Math.floor(Math.random() * 480), 
            width: 50, 
            height: 50, 
            rotationSpeed: Math.random()*.10,
            fillColor: "rgba("+red+", "+green+", "+blue+", "+opacity+")", 
            direction: direction
          });
          allShapes.push(rect); 
        }
        return allShapes;
      }
      function draw() {
        var canvas = document.getElementById('tutorial');

        if (canvas.getContext) {
          var ctx = canvas.getContext('2d');
          ctx.clearRect(0, 0, 640, 480);
          for (i=0; i < allShapes.length; ++i) {
            allShapes[i].draw(ctx);
          } 
        }
      }

      var allShapes = generateShapes(NUMBER_OF_RECTANGLES);

      init();
    </script>
    <style type="text/css">
      canvas {
        border: 1px solid black;
      }
    </style>
  </head>
  <body>
    <canvas id="tutorial" width="640" height="480" />
  </body>
</html>
